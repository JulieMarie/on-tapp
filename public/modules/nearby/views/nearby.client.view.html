<section data-ng-controller="NearbyController">
  <div class="container-fluid">
    <ui-gmap-google-map center="map.center" zoom="map.zoom" draggable="true" options="options" bounds="map.bounds">
      <ui-gmap-marker coords="marker.coords" options="marker.options" idkey="marker.id" click="'onClick'">
      <ui-gmap-markers models="allMarkers" coords="'self'" options="'options'" icon="'icon'" click="'onClick'">
        <ui-gmap-windows show="show">
          <div ng-non-bindable>{{title}}</div>
        </ui-gmap-windows>
      </ui-gmap-markers>

      <!-- marker to show user cuurent coordinate -->
      <ui-gmap-marker coords="marker.coords" options="marker.options" events="marker.events" idkey="marker.id">
      </ui-gmap-marker>

    </ui-gmap-google-map>

    <hr>
<!--
    <button class="btn btn-success btn-lg" ng-click="getCurrentLocation()"> Get my location</button>
    <p class="pull-right">My current location is: {{coords.lat}}, {{coords.long}}</p>

    <hr> -->

    <div class="container-fluid">
      <accordion>
        <accordion-group ng-repeat="brewery in breweries | orderBy: 'distance'" is-open="status.isItemOpen[$index]">
          <accordion-heading>
            {{brewery.brewery.name}} <span class="pull-right badge">Distance: {{brewery.distance}} miles</span>
          </accordion-heading>
            <div class="row">
              <div class="col-sm-4">
                <div ng-if="brewery.brewery.images.medium">
                  <img class="brewery-img img-responsive center-block" src="{{brewery.brewery.images.medium}}">
                </div>
                <div ng-if="brewery.brewery.established">
                  <p class="center"><strong>Established:</strong> {{brewery.brewery.established}}</p>
                </div>
                <div ng-if="brewery.brewery.website">
                  <p class="center"><a href="{{brewery.brewery.website}}" target="_blank">{{brewery.brewery.website}}</a></p>
                </div>
                <div ng-if="brewery.brewery.isOrganic == 'Y'">
                  <p class="center">Certified Organic</p>
                </div>
                <p class="beer-btn"><a class="btn btn-info btn-sm" href="#!/beers/{{brewery.brewery.id}}" role="button">List their beers &raquo;</a></p>
              </div>
              <div class="col-sm-8">
                <p class="content">{{brewery.brewery.description}}</p>
                <!-- <p><a class="btn btn-primary pull-right" href="#/ratings" role="button">Give your ratings &raquo;</a></p> -->
              </div>

              <div class="well">
                <p>Give your ratings to {{brewery.brewery.name}}:</p>
                <rating class="stars" ng-model="rate" max="max" readonly="isReadonly" on-hover="hoveringOver(value)" on-leave="overStar = null"></rating>

                <pre style="margin:15px 0;">Stars: <b>{{rate}}</b>  <span class="label" ng-class="{'label-warning': percent<30, 'label-info': percent>=30 && percent<70, 'label-success': percent>=70}" ng-show="overStar && !isReadonly">{{percent}}%</span></b></pre>

                <button class="btn btn-lg btn-danger" ng-click="reset()" ng-disabled="isReadonly">Clear</button>
                <button class="btn btn-lg btn-success" ng-click="isReadonly = ! isReadonly; saveRating()">Save</button>
               </div>
            </div>
        </accordion-group>
      </accordion>
    </div>
  </div>
</section>
